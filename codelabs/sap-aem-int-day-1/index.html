
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Event Enable SAP Using SAP Advanced Event Mesh</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" ga4id=""></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  codelab-ga4id=""
                  id="sap-aem-int-day-1"
                  title="Event Enable SAP Using SAP Advanced Event Mesh"
                  environment="web"
                  feedback-link="https://github.com/SolaceDev/solace-dev-codelabs/blob/master/markdown/sap-aem-int-day-1">
    
      <google-codelab-step label="What you&#39;ll learn: Overview" duration="5">
        <p>Day 1 of 5. Topics covered :</p>
<ul>
<li>Setup AEM Services</li>
<li>Build an event mesh</li>
<li>Deploy SAP CAP based Simulator on CloudFoundry</li>
<li>Test the Simulator and publish SAP objects to the Event Mesh</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="What you need: Prerequisites" duration="7">
        <p>Enter environment setup &amp; prerequisites here</p>
<iframe class="embedded-iframe" src="https://codepen.io/tzoght/embed/yRNZaP"></iframe>


      </google-codelab-step>
    
      <google-codelab-step label="Step 1 - Create AEM Services" duration="0">
        <p>In this task, you will be creating two Enterprise AEM services, meshing them, and verifying your mesh health.</p>
<p>Before starting, it will be helpful to know what cloud provider and region your SAP environment is in, and the primary cloud provider and region where your cloud applications are deployed. The value of building a mesh topology is realized when placing your AEM services close to your event producing and consuming systems. If your SAP environment is running in an on-premises data center, you will use the geographic region of that site to help select an appropriate cloud location for that AEM service.</p>
<h2 is-upgraded>Create your first AEM service:</h2>
<ol type="1">
<li>From the SAP AEM Console, open the Cluster Manager.<br><img alt="AEM Cluster Manager" src="img/d6ee451c2c736db7.png"></li>
<li>Click the + box to create a new AEM service.<br><img alt="AEM Cluster Manager Plus sign" src="img/40b458ee79ba0616.png"></li>
<li>Name your service<br><img alt="AEM Cluster Manager New service" src="img/f905ea1d423e81aa.png"><aside class="warning"><p> Note that service names must be unique within your account. We suggest using the mesh name you want, a hyphen, and a service ID to make it unique.</p>
</aside>
</li>
<li>Pick Enterprise as the service type.<br><img alt="AEM Cluster Manager New service type" src="img/c5a7fb25ffdf120d.png"><br> For now, keep the default service class and message storage settings.</li>
<li>Choose your cloud provider from the pull down list.<br><br> For the first AEM service, select the same IaaS (Infrastructure as a Service) provider and region where your SAP is running, the RISE provider and region where your SAP Cloud is running, or for an on-premises SAP pick a cloud provider and region closest to where your data center is located.<br><br> For the second AEM service, select the same provider and region where your cloud applications are located. If you have several, pick one that is distant from your SAP environment (you can expand your mesh later to include additional cloud locations).<br><img alt="AEM Cluster Manager New service cloud provider" src="img/b72171e5ac906032.png"><aside class="warning"><p> Note that you can also request buildout of a private cloud region on-premises at your data center later, but for now please select the best matching cloud provider.</p>
</aside>
</li>
<li>Click the Select Region box inside the map and select your cloud region.<br><img alt="AEM Cluster Manager New service region" src="img/49c5f913899d9511.png"><br> This example shows selecting Azure as the provider and East US 2 (Virginia) as the region:<br><img alt="AEM Cluster Manager New service Azure USEas2" src="img/e160966abfa6e8f1.png"><br> Please substitute your best provider and region as you make your selection and click OK.</li>
<li>Keep the Default Broker Version selection.<br><img alt="AEM Cluster Manager New service broker version" src="img/4becf77382baa3b9.png"></li>
<li>Expand the Advanced Connection Options section.<br><img alt="AEM Cluster Manager New service Broker Adv. Option" src="img/8f193a5170e72aa2.png"></li>
<li>Enter the name for your cluster. <br> AEM services can be clustered within a cloud location to expand capacity horizontally. These clusters can then be interconnected across cloud locations to form a mesh. Today, we will create two clusters of one AEM service each and then interconnect them. <br> When clicking in the Cluster Name field, you will see a pull-down menu of existing clusters (the list will likely be empty) and a search box at the top. <br> Click in the search box and use your mesh name plus the cloud provider and region to define the name of your cluster. As you type, the search results will include the cluster name you are defining:<br><img alt="AEM Cluster Manager New service Broker Mesh name" src="img/f9c2fa8c7b599e43.png"><br> Remember to use your specific mesh name, provider and region followed by the word Cluster and then click your cluster name in the search result to select it:<br><img alt="AEM Cluster Manager New service Broker New Mesh name" src="img/c6dab0f8876bd646.png"><br> Leave the Enable mate-link encryption checkbox selected.</li>
<li>Set the Message VPN Name. <br> By default, each AEM service has a unique VPN name. The message VPN is a logical messaging domain where events are shared by producing and consuming applications. For our evaluation exercise, we will use a single message VPN across both AEM services.<br> Click on the pencil icon to the right of the Message VPN Name field and set the name to your mesh name followed by the keyword VPN :<br><img alt="AEM Cluster Manager New service Broker Msg VPN name" src="img/2bd6bbc17d806141.png"><br> Leave the Port Configuration section default values for now. After reviewing all the settings on the Create Service page, click Create Service to launch your AEM service.<br><img alt="AEM Cluster Manager New service Broker Create-button" src="img/fd7a76c766a7b42d.png"><br> You will see a progress bar as the service is being started. Click the back-arrow at the top of the window next to your service name to return to the Cluster Manager view. You will see your AEM service instance with the progress bar.<br><img alt="AEM Cluster Manager New service Broker Progress" src="img/a5e64dd9cf4d24d0.png"><br> You can proceed with the next step while your first AEM service is starting.</li>
<li>Repeat steps 2 through 10 for your second AEM service.<br> Substitute the name (Svc2) along with the appropriate cloud provider and region.<aside class="warning"><p> Note that your second service can be with the same cloud provider or a different cloud provider.<br> For example, it is common for organizations to use Azure as their SAP IaaS provider for cost/location reasons, but to have applications being built in AWS or another cloud provider.</p>
</aside>
<strong>IMPORTANT - For your second AEM service:</strong><ul>
<li>Location will be in a <strong>DIFFERENT region</strong> (with the same or different cloud provider).</li>
<li>The <strong>cluster name</strong> follows the same pattern but is <strong>DIFFERENT</strong> from the first AEM service.</li>
<li>You will use the <strong>EXACT SAME Message VPN Name</strong> as for the first AEM service.</li>
</ul>
Once your services have started, you can click to open them and view details of their status: <img alt="AEM Cluster Manager Services list" src="img/26d70f2273921d25.png"><aside class="warning"><p> (Note - This example shows developer class services)</p>
</aside>
Click on each service to inspect the detailed status:<br><img alt="AEM Cluster Service-1 details" src="img/c46de2cb3850e8c8.png"><br> This example shows low utilization, version detail and cluster detail which includes the message VPN name which should be the same for both AEM services.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Step 2 - Build an event mesh" duration="0">
        <ol type="1">
<li>Define a new mesh. From the SAP AEM Console, open the Mesh Manager:<br><img alt="AEM Console Mesh Manager" src="img/5dbca0e1bbd1c46c.png"><br> In the top right, click the Create Mesh action to open the mesh definition.<br><img alt="AEM Console Mesh Manager Create" src="img/a53778017c1b7c91.png"><br> Enter the same mesh name used when defining your AEM services.<br><img alt="AEM Console Mesh Manager Create" src="img/8e5c618902a3f016.png"></li>
<li>Add your AEM services to the mesh.<br> Click Add Service, then use the pull down search box to find and select your first service.<br><img alt="AEM Mesh Manager Add service-1" src="img/4a29b4de67a42c4f.png"><br> Click Add Service in the dialog to complete the action:<br><img alt="AEM Mesh Manager Add service complete" src="img/6055fb52e9a6f3a7.png"><br> Click Add Service again and add your second service.<br><img alt="AEM Mesh Manager Add service2" src="img/3dd3260bef8484e6.png"><br> Mesh Manager will show the layout of your mesh geography.<br><img alt="AEM Mesh Manager geography" src="img/abdd95dce462cada.png"><br> Click Create Mesh to complete the mesh setup.<br><img alt="AEM Mesh Manager create" src="img/53d2a7b73e260d23.png"><br> Mesh Manager will update the status of your mesh when configuration is complete.<br><img alt="AEM Mesh Manager complete" src="img/1c9f5a982fae5e7d.png"></li>
<li>(<strong>Optional</strong>) Run a health check on your event mesh. From the Mesh Manager, click on your event mesh to open the status page :<br><img alt="AEM Mesh Manager Status check" src="img/a91bed91221af860.png"><br> Expand the Latest Health Check and click Run Health Check action:<br><img alt="AEM Mesh Manager Health check" src="img/9ddb486d82d9b63a.png"><br> The health check progress is shown, followed by the health check status:<br><img alt="AEM Mesh Manager Health check Status" src="img/f4e5475577df98a4.png"></li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Step 3 - SAP Simulator setup" duration="0">
        <p>The SAP Cloud Application Programming Model (CAP) is a framework of languages, libraries, and tools for building enterprise-grade services and applications. It guides developers along a ‘golden path&#39; of proven best practices and a great wealth of out-of-the-box solutions to recurring tasks. CAP-based projects benefit from a primary focus on domain. Instead of delving into overly technical disciplines, we focus on accelerated development and safeguarding investments in a world of rapidly changing cloud technologies.</p>
<p>For more information on SAP CAP, you can refer to the link : <a href="https://cap.cloud.sap/docs/" target="_blank">SAP Cloud Application Programming Model</a></p>
<p>To showcase the integration capability of SAP CAP and AEM, we have created a CAP based Java microservice which will publish different SAP business object events into your AEM instance. This application can be deployed in your SAP CloudFoundry space.</p>
<h2 is-upgraded>1 : CloudFoundry CLI installation</h2>
<p>To start with, we will be installing the CloudFoundry CLI for the deployment process. Follow the steps mentioned over here <a href="https://github.com/cloudfoundry/cli/wiki/V8-CLI-Installation-Guide" target="_blank">Installing the cf CLI</a> for detailed instructions on this.</p>
<h2 is-upgraded>2 : Downloading the deployables artefacts</h2>
<p>Download the following files artefact files and save them in the same directory:</p>
<ul>
<li>capm-erp-simulation-exec.jar : <a href="https://github.com/SolaceLabs/aem-sap-integration/blob/main/deployable/capm-erp-simulation-exec.jar" target="_blank">https://github.com/SolaceLabs/aem-sap-integration/blob/main/deployable/capm-erp-simulation-exec.jar</a></li>
<li>manifest.yml : <a href="https://github.com/SolaceLabs/aem-sap-integration/blob/main/deployable/manifest.yml" target="_blank">https://github.com/SolaceLabs/aem-sap-integration/blob/main/deployable/manifest.yml</a></li>
</ul>
<h2 is-upgraded>3 : Login to CloudFoundry space</h2>
<p>You can log in to the SAP CloudFoundry space in your account as below :</p>
<ul>
<li>Use the command : <code>cf login</code> to log in, which will prompt for your SAP login credentials.</li>
<li>Once authenticated, the details of the default cloudfoundry space will be displayed.</li>
</ul>
<h2 is-upgraded>4 : Deploying the SAP Simulator application</h2>
<ul>
<li>Navigate to the directory where the above deployable artefact files are saved.</li>
<li>Run the command <code>cf push</code> which will upload the jar file and use the manifest.yml for properties. <strong>Note : this command will take some time to completely execute as it uploads the jar deployable and also start the application.</strong></li>
<li>Once the command is completely executed, run the command <code>cf apps</code> to view a listing of the apps in your cloudfoundry space</li>
<li>Verify that the app <strong>capm-erp-simulation</strong> is deployed and started</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Step 4 - Test SAP Simulator" duration="0">
        <h2 is-upgraded>1 : Accessing the SAP Simulator application</h2>
<ul>
<li>Navigate to the Cloud Foundry environment in your SAP BTP Cockpit</li>
<li>You should see a screen like below : <img alt="Cloud Foundry Space" src="img/208778290e3cd8a9.png"></li>
<li>Click on the application name : <strong>capm-erp-simulation</strong> and enter the application overview screen. <img alt="capm-erp-simulation-Overview" src="img/c2dd6c7c29d488d8.png"></li>
<li>Click on the application route as highlighted below. Note : this route url will differ from for different SAP BTP accounts. <img alt="capm-erp-simulation-Overview" src="img/dd60d3caf8afe398.png"></li>
</ul>
<h2 is-upgraded>2 : Connecting to SAP AEM and running the simulator</h2>
<ul>
<li>As you click on the above application route url, you will be redirected to the simulator screen as below <img alt="Simulator connection screen" src="img/c6759297a02c87fc.png"> Here you can connect to your SAP AEM instance to publish events.</li>
<li>The connection parameters for the simulator can be captured from below : <img alt="Broker console connect screen" src="img/3e8e66d3a1fcf752.png"><img alt="Console-Connect - Java Spring" src="img/f8a81cec5a7fb67e.png"> Enter the appropriate value as specified below :</li>
<li>Host URL : Public Endpoint</li>
<li>VPN Name : Message VPN</li>
<li>Username : Username</li>
<li>Password : Password <img alt="Console-Connect - Creds highlighted" src="img/76bb965d88c4bdd.png"></li>
<li>Once the broker is successfully connected, you will be displayed a screen as below : <img alt="Simulator connected screen" src="img/6625ffc92d379ca9.png"></li>
<li>You can choose which events to simulate and its frequency by using the sliders. As you change a schedule, the submit button in the bottom will be enabled <img alt="Simulator scheduling" src="img/351c71924c528784.png"></li>
<li>In case you want to disable any of the events, then pull the slider to <strong>0</strong> and click submit and the event will be disabled immediately <img alt="Simulator disabling" src="img/540804a93303a315.png"></li>
</ul>
<h2 is-upgraded>3 : Test the incoming events</h2>


      </google-codelab-step>
    
      <google-codelab-step label="Takeaways" duration="7">
        <p>✅ &lt; Fill IN TAKEAWAY 1&gt;<br> ✅ &lt; Fill IN TAKEAWAY 2&gt;<br> ✅ &lt; Fill IN TAKEAWAY 3&gt;</p>
<p class="image-container"><img alt="Soly Image Caption" src="img/44f356558033e250.gif"></p>
<p>Thanks for participating in this codelab! Let us know what you thought in the <a href="https://solace.community/" target="_blank">Solace Community Forum</a>! If you found any issues along the way we&#39;d appreciate it if you&#39;d raise them by clicking the Report a mistake button at the bottom left of this codelab.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
